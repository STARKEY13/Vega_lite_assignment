<!DOCTYPE html>
<html>
<head>
    <title>Visualizing Tables using Vega-Lite</title>
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
    <style>
      body {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
        background-color: #f0f0f0;
        font-family: Arial, sans-serif;
      }
      #vis {
        width: 80%;
        margin: auto;
      }
    </style>
  </head>
  <body>
    <h1 style="text-align:center;">Visualizing Tables using Vega-Lite</h1>
    <div id="vis"></div>
    <script type="text/javascript">
    var yourData = [
      // Your converted data from HW_III.xlsx goes here
      {
        "SalesOrders":[
         {
          "OrderDate": "1\/6\/21",
          "Region": "East",
          "Rep": "Jones",
          "Item": "Pencil",
          "Units": 95,
          "Unit Cost": 1.99,
          "Total": 189.05
         },
         {
          "OrderDate": "1\/23\/21",
          "Region": "Central",
          "Rep": "Kivell",
          "Item": "Binder",
          "Units": 50,
          "Unit Cost": 19.99,
          "Total": 999.4999999999999
         },
         {
          "OrderDate": "2\/9\/21",
          "Region": "Central",
          "Rep": "Jardine",
          "Item": "Pencil",
          "Units": 36,
          "Unit Cost": 4.99,
          "Total": 179.64
         },
         {
          "OrderDate": "2\/26\/21",
          "Region": "Central",
          "Rep": "Gill",
          "Item": "Pen",
          "Units": 27,
          "Unit Cost": 19.99,
          "Total": 539.7299999999999
         },
         {
          "OrderDate": "3\/15\/21",
          "Region": "West",
          "Rep": "Sorvino",
          "Item": "Pencil",
          "Units": 56,
          "Unit Cost": 2.99,
          "Total": 167.44
         },
         {
          "OrderDate": "4\/1\/21",
          "Region": "East",
          "Rep": "Jones",
          "Item": "Binder",
          "Units": 60,
          "Unit Cost": 4.99,
          "Total": 299.40000000000003
         },
         {
          "OrderDate": "4\/18\/21",
          "Region": "Central",
          "Rep": "Andrews",
          "Item": "Pencil",
          "Units": 75,
          "Unit Cost": 1.99,
          "Total": 149.25
         },
         {
          "OrderDate": "5\/5\/21",
          "Region": "Central",
          "Rep": "Jardine",
          "Item": "Pencil",
          "Units": 90,
          "Unit Cost": 4.99,
          "Total": 449.1
         },
         {
          "OrderDate": "5\/22\/21",
          "Region": "West",
          "Rep": "Thompson",
          "Item": "Pencil",
          "Units": 32,
          "Unit Cost": 1.99,
          "Total": 63.68
         },
         {
          "OrderDate": "6\/8\/21",
          "Region": "East",
          "Rep": "Jones",
          "Item": "Binder",
          "Units": 60,
          "Unit Cost": 8.99,
          "Total": 539.4
         },
         {
          "OrderDate": "6\/25\/21",
          "Region": "Central",
          "Rep": "Morgan",
          "Item": "Pencil",
          "Units": 90,
          "Unit Cost": 4.99,
          "Total": 449.1
         },
         {
          "OrderDate": "7\/12\/21",
          "Region": "East",
          "Rep": "Howard",
          "Item": "Binder",
          "Units": 29,
          "Unit Cost": 1.99,
          "Total": 57.71
         },
         {
          "OrderDate": "7\/29\/21",
          "Region": "East",
          "Rep": "Parent",
          "Item": "Binder",
          "Units": 81,
          "Unit Cost": 19.99,
          "Total": 1619.1899999999998
         },
         {
          "OrderDate": "8\/15\/21",
          "Region": "East",
          "Rep": "Jones",
          "Item": "Pencil",
          "Units": 35,
          "Unit Cost": 4.99,
          "Total": 174.65
         },
         {
          "OrderDate": "9\/1\/21",
          "Region": "Central",
          "Rep": "Smith",
          "Item": "Desk",
          "Units": 2,
          "Unit Cost": 125,
          "Total": 250
         },
         {
          "OrderDate": "9\/18\/21",
          "Region": "East",
          "Rep": "Jones",
          "Item": "Pen Set",
          "Units": 16,
          "Unit Cost": 15.99,
          "Total": 255.84
         },
         {
          "OrderDate": "10\/5\/21",
          "Region": "Central",
          "Rep": "Morgan",
          "Item": "Binder",
          "Units": 28,
          "Unit Cost": 8.99,
          "Total": 251.72
         },
         {
          "OrderDate": "10\/22\/21",
          "Region": "East",
          "Rep": "Jones",
          "Item": "Pen",
          "Units": 64,
          "Unit Cost": 8.99,
          "Total": 575.36
         },
         {
          "OrderDate": "11\/8\/21",
          "Region": "East",
          "Rep": "Parent",
          "Item": "Pen",
          "Units": 15,
          "Unit Cost": 19.99,
          "Total": 299.84999999999997
         },
         {
          "OrderDate": "11\/25\/21",
          "Region": "Central",
          "Rep": "Kivell",
          "Item": "Pen Set",
          "Units": 96,
          "Unit Cost": 4.99,
          "Total": 479.04
         },
         {
          "OrderDate": "12\/12\/21",
          "Region": "Central",
          "Rep": "Smith",
          "Item": "Pencil",
          "Units": 67,
          "Unit Cost": 1.29,
          "Total": 86.43
         },
         {
          "OrderDate": "12\/29\/21",
          "Region": "East",
          "Rep": "Parent",
          "Item": "Pen Set",
          "Units": 74,
          "Unit Cost": 15.99,
          "Total": 1183.26
         },
         {
          "OrderDate": "1\/15\/22",
          "Region": "Central",
          "Rep": "Gill",
          "Item": "Binder",
          "Units": 46,
          "Unit Cost": 8.99,
          "Total": 413.54
         },
         {
          "OrderDate": "2\/1\/22",
          "Region": "Central",
          "Rep": "Smith",
          "Item": "Binder",
          "Units": 87,
          "Unit Cost": 15,
          "Total": 1305
         },
         {
          "OrderDate": "2\/18\/22",
          "Region": "East",
          "Rep": "Jones",
          "Item": "Binder",
          "Units": 4,
          "Unit Cost": 4.99,
          "Total": 19.96
         },
         {
          "OrderDate": "3\/7\/22",
          "Region": "West",
          "Rep": "Sorvino",
          "Item": "Binder",
          "Units": 7,
          "Unit Cost": 19.99,
          "Total": 139.92999999999998
         },
         {
          "OrderDate": "3\/24\/22",
          "Region": "Central",
          "Rep": "Jardine",
          "Item": "Pen Set",
          "Units": 50,
          "Unit Cost": 4.99,
          "Total": 249.5
         },
         {
          "OrderDate": "4\/10\/22",
          "Region": "Central",
          "Rep": "Andrews",
          "Item": "Pencil",
          "Units": 66,
          "Unit Cost": 1.99,
          "Total": 131.34
         },
         {
          "OrderDate": "4\/27\/22",
          "Region": "East",
          "Rep": "Howard",
          "Item": "Pen",
          "Units": 96,
          "Unit Cost": 4.99,
          "Total": 479.04
         },
         {
          "OrderDate": "5\/14\/22",
          "Region": "Central",
          "Rep": "Gill",
          "Item": "Pencil",
          "Units": 53,
          "Unit Cost": 1.29,
          "Total": 68.37
         },
         {
          "OrderDate": "5\/31\/22",
          "Region": "Central",
          "Rep": "Gill",
          "Item": "Binder",
          "Units": 80,
          "Unit Cost": 8.99,
          "Total": 719.2
         },
         {
          "OrderDate": "6\/17\/22",
          "Region": "Central",
          "Rep": "Kivell",
          "Item": "Desk",
          "Units": 5,
          "Unit Cost": 125,
          "Total": 625
         },
         {
          "OrderDate": "7\/4\/22",
          "Region": "East",
          "Rep": "Jones",
          "Item": "Pen Set",
          "Units": 62,
          "Unit Cost": 4.99,
          "Total": 309.38
         },
         {
          "OrderDate": "7\/21\/22",
          "Region": "Central",
          "Rep": "Morgan",
          "Item": "Pen Set",
          "Units": 55,
          "Unit Cost": 12.49,
          "Total": 686.95
         },
         {
          "OrderDate": "8\/7\/22",
          "Region": "Central",
          "Rep": "Kivell",
          "Item": "Pen Set",
          "Units": 42,
          "Unit Cost": 23.95,
          "Total": 1005.9
         },
         {
          "OrderDate": "8\/24\/22",
          "Region": "West",
          "Rep": "Sorvino",
          "Item": "Desk",
          "Units": 3,
          "Unit Cost": 275,
          "Total": 825
         },
         {
          "OrderDate": "9\/10\/22",
          "Region": "Central",
          "Rep": "Gill",
          "Item": "Pencil",
          "Units": 7,
          "Unit Cost": 1.29,
          "Total": 9.030000000000001
         },
         {
          "OrderDate": "9\/27\/22",
          "Region": "West",
          "Rep": "Sorvino",
          "Item": "Pen",
          "Units": 76,
          "Unit Cost": 1.99,
          "Total": 151.24
         },
         {
          "OrderDate": "10\/14\/22",
          "Region": "West",
          "Rep": "Thompson",
          "Item": "Binder",
          "Units": 57,
          "Unit Cost": 19.99,
          "Total": 1139.4299999999998
         },
         {
          "OrderDate": "10\/31\/22",
          "Region": "Central",
          "Rep": "Andrews",
          "Item": "Pencil",
          "Units": 14,
          "Unit Cost": 1.29,
          "Total": 18.060000000000002
         },
         {
          "OrderDate": "11\/17\/22",
          "Region": "Central",
          "Rep": "Jardine",
          "Item": "Binder",
          "Units": 11,
          "Unit Cost": 4.99,
          "Total": 54.89
         },
         {
          "OrderDate": "12\/4\/22",
          "Region": "Central",
          "Rep": "Jardine",
          "Item": "Binder",
          "Units": 94,
          "Unit Cost": 19.99,
          "Total": 1879.06
         },
         {
          "OrderDate": "12\/21\/22",
          "Region": "Central",
          "Rep": "Andrews",
          "Item": "Binder",
          "Units": 28,
          "Unit Cost": 4.99,
          "Total": 139.72
         }
        ]
        }
    ];
    // Flatten your data
    var flattenedData = yourData.flatMap(d => d.SalesOrders);

    var donutSpec = {
        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
        "title": "Donut Chart",
        "data": { "values": flattenedData },
        "mark": { "type": "arc", "innerRadius": 50 },
        "encoding": {
          "theta": { "field": "Total", "type": "quantitative" },
          "color": { "field": "Rep", "type": "nominal" }
        },
        "view": { "stroke": null }
      };
      var correlationSpec = {
        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
        "title": "Correlation between Units and Unit Cost",
        "data": { "values": flattenedData },
        "selection": {
          "brush": {"type": "interval"}
        },
        "mark": "point",
        "encoding": {
          "x": {"field": "Units", "type": "quantitative"},
          "y": {"field": "Unit Cost", "type": "quantitative"},
          "color": {
            "condition": {"selection": "brush", "field": "Item", "type": "nominal"},
            "value": "grey"
          }
        }
      };
      var streamgraphSpec = {
        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
        "title": "Streamgraph of Total over Time",
        "data": { "values": flattenedData },
        "mark": "area",
        "encoding": {
          "x": {"field": "OrderDate", "type": "temporal"},
          "y": {"field": "Total", "type": "quantitative", "stack": "center"},
          "color": {"field": "Item", "type": "nominal"}
        }
      };
      var histogramSpec = {
        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
        "title": "Histogram of Units",
        "data": { "values": flattenedData },
        "layer": [
          {
            "mark": "bar",
            "encoding": {
              "x": {"field": "Units", "type": "quantitative", "bin": true},
              "y": {"aggregate": "count", "type": "quantitative"}
            }
          },
          {
            "mark": "rule",
            "encoding": {
              "x": {"field": "Units", "type": "quantitative", "aggregate": "mean"},
              "color": {"value": "red"},
              "size": {"value": 2}
            }
          }
        ]
      };
      var gridSpec = {
        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
        "vconcat": [
          {
            "hconcat": [donutSpec, correlationSpec]
          },
          {
            "hconcat": [streamgraphSpec, histogramSpec]
          }
        ]
      };
      
      vegaEmbed('#vis', gridSpec);
      
      
      /*var multiViewSpec = {
        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
        "vconcat": [donutSpec, correlationSpec, streamgraphSpec, histogramSpec]
      };
      
      vegaEmbed('#vis', multiViewSpec);*/
                        
      
  </script>
</body>
</html>
